(window.webpackJsonp=window.webpackJsonp||[]).push([[27],{1239:function(r,t,a){"use strict";a.r(t);var e=a(4),n=Object(e.a)({},(function(){var r=this,t=r._self._c;return t("ContentSlotsDistributor",{attrs:{"slot-key":r.$parent.slotKey}},[t("h1",{attrs:{id:"服务监控"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#服务监控"}},[r._v("#")]),r._v(" 服务监控")]),r._v(" "),t("p",[r._v("系统使用 Spring Boot Admin 和 SkyWalking 实现后端服务的监控。")]),r._v(" "),t("h2",{attrs:{id:"_1-spring-boot-admin"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#_1-spring-boot-admin"}},[r._v("#")]),r._v(" 1. Spring Boot Admin")]),r._v(" "),t("p",[r._v("阅读 "),t("a",{attrs:{href:"https://www.iocoder.cn/Spring-Boot/Admin/?yudao",target:"_blank",rel:"noopener noreferrer"}},[r._v("《芋道 Spring Boot 监控工具 Admin 入门》 "),t("OutboundLink")],1),r._v("文章，入门 Spring Boot Admin。")]),r._v(" "),t("p",[r._v("注意，Spring Boot Admin 是内嵌在 "),t("code",[r._v("yudao-server")]),r._v(" 后端项目中，无需单独启动。")]),r._v(" "),t("h3",{attrs:{id:"_1-1-配置"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#_1-1-配置"}},[r._v("#")]),r._v(" 1.1 配置")]),r._v(" "),t("p",[r._v("在 "),t("a",{attrs:{href:"https://github.com/YunaiV/ruoyi-vue-pro/blob/master/yudao-server/src/main/resources/application-local.yaml#L136-L146",target:"_blank",rel:"noopener noreferrer"}},[t("code",[r._v("application-local.yaml")]),r._v(" "),t("OutboundLink")],1),r._v("配置文件中，通过 "),t("code",[r._v("spring.boot.admin")]),r._v(" 配置项，设置 Spring Boot Admin 的配置。如下图所示：")]),r._v(" "),t("img",{attrs:{src:a(823)}}),r._v(" "),t("p",[r._v("疑问：prod 生产环境下，后端部署多个 JVM 进程时，spring.boot.admin.client.url 填写哪个 IP？")]),r._v(" "),t("ul",[t("li",[r._v("第一步，在 Nginx 中配置 "),t("code",[r._v("/admin")]),r._v(" 路径，转发到多个 JVM 的 IP 上，使用 "),t("a",{attrs:{href:"https://blog.csdn.net/bolg_hero/article/details/73382117",target:"_blank",rel:"noopener noreferrer"}},[t("code",[r._v("backup")]),r._v(" "),t("OutboundLink")],1),r._v("参数实现主备。注意，该转发只允许内网访问，避免安全问题！！！")]),r._v(" "),t("li",[r._v("第二步，设置 "),t("code",[r._v("spring.boot.admin.client.url")]),r._v(" 配置项，为 Nginx 的 "),t("code",[r._v("内置 IP/admin")]),r._v(" 地址。")])]),r._v(" "),t("h3",{attrs:{id:"_1-2-使用"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#_1-2-使用"}},[r._v("#")]),r._v(" 1.2 使用")]),r._v(" "),t("p",[r._v("① 访问 "),t("a",{attrs:{href:"http://127.0.0.1:48080/",target:"_blank",rel:"noopener noreferrer"}},[r._v("http://127.0.0.1:48080/ "),t("OutboundLink")],1),r._v("地址，可以在 Spring Boot Admin 中，查看到应用与实例的列表。如下图所示：")]),r._v(" "),t("p",[r._v("友情提示：也可以通过前端的 [基础设施 -> Java 监控] 菜单。")]),r._v(" "),t("img",{attrs:{src:a(824)}}),r._v(" "),t("p",[r._v("② 点击 "),t("code",[r._v("yudao-server")]),r._v(" 应用，再点击实例，可以查看到该实例的细节信息。如下图所示：")]),r._v(" "),t("img",{attrs:{src:a(825)}}),r._v(" "),t("p",[r._v("③ 点击 [日志 -> 日志文件] 菜单，查看该示例的日志内容。如下图所示：")]),r._v(" "),t("img",{attrs:{src:a(826)}}),r._v(" "),t("p",[r._v("点击 [日志 -> 日志文件] 菜单，可动态修改 Logger 的日志级别，方便排查线上的某些 BUG。如下图所示：")]),r._v(" "),t("img",{attrs:{src:a(827)}}),r._v(" "),t("h2",{attrs:{id:"_2-skywalking"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#_2-skywalking"}},[r._v("#")]),r._v(" 2. SkyWalking")]),r._v(" "),t("p",[r._v("阅读 "),t("a",{attrs:{href:"https://www.iocoder.cn/SkyWalking/install/?yudao",target:"_blank",rel:"noopener noreferrer"}},[r._v("《芋道 SkyWalking 极简入门》 "),t("OutboundLink")],1),r._v("文章，入门 SkyWalking。")]),r._v(" "),t("p",[r._v("注意，SkyWalking 需要单独启动，预计需要 4 核 8G 的硬件资源。")]),r._v(" "),t("h3",{attrs:{id:"_2-1-配置"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#_2-1-配置"}},[r._v("#")]),r._v(" 2.1 配置")]),r._v(" "),t("p",[r._v("① 在 "),t("a",{attrs:{href:"https://github.com/YunaiV/ruoyi-vue-pro/blob/master/yudao-server/src/main/resources/logback-spring.xml",target:"_blank",rel:"noopener noreferrer"}},[t("code",[r._v("logback-spring.xml")]),r._v(" "),t("OutboundLink")],1),r._v("配置文件中，添加 SkyWalking 收集日志的 appender 配置。如下图所示：")]),r._v(" "),t("img",{attrs:{src:a(828)}}),r._v(" "),t("p",[r._v("② 修改 SkyWalking 在前端项目的 [基础设施 -> 监控平台] 对应的 "),t("a",{attrs:{href:"https://github.com/YunaiV/ruoyi-vue-pro/blob/master/yudao-ui-admin/src/views/infra/skywalking/index.vue#L11",target:"_blank",rel:"noopener noreferrer"}},[t("code",[r._v("skywaling/index.vue")]),r._v(" "),t("OutboundLink")],1),r._v("文件，调整为你 SkyWalking 的访问地址。如下图所示：")]),r._v(" "),t("img",{attrs:{src:a(829)}}),r._v(" "),t("h3",{attrs:{id:"_2-2-使用"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#_2-2-使用"}},[r._v("#")]),r._v(" 2.2 使用")]),r._v(" "),t("p",[r._v("① 点击 [基础设施 -> 监控平台] 菜单，可以看到 SkyWalking 提供的监控平台。如下图所示：")]),r._v(" "),t("img",{attrs:{src:a(830)}}),r._v(" "),t("p",[r._v("② 点击 "),t("code",[r._v("yudao-server")]),r._v(" 服务，查看该服务的监控信息。如下图所示：")]),r._v(" "),t("img",{attrs:{src:a(831)}}),r._v(" "),t("h2",{attrs:{id:"_3-更多监控系统"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#_3-更多监控系统"}},[r._v("#")]),r._v(" 3. 更多监控系统")]),r._v(" "),t("h3",{attrs:{id:"_3-1-prometheus"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#_3-1-prometheus"}},[r._v("#")]),r._v(" 3.1 Prometheus")]),r._v(" "),t("p",[r._v("参见 "),t("a",{attrs:{href:"https://www.iocoder.cn/Prometheus/install/?yudao",target:"_blank",rel:"noopener noreferrer"}},[r._v("《芋道 Prometheus + Grafana + Alertmanager 极简入门 》 "),t("OutboundLink")],1),r._v("文章。")]),r._v(" "),t("h3",{attrs:{id:"_3-2-elk"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#_3-2-elk"}},[r._v("#")]),r._v(" 3.2 ELK")]),r._v(" "),t("p",[r._v("参见 "),t("a",{attrs:{href:"https://www.iocoder.cn/Elasticsearch/ELK-install/?yudao",target:"_blank",rel:"noopener noreferrer"}},[r._v("芋道 ELK(Elasticsearch + Logstash + Kibana) 极简入门 "),t("OutboundLink")],1),r._v("文章。")]),r._v(" "),t("h3",{attrs:{id:"_3-3-sentry"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#_3-3-sentry"}},[r._v("#")]),r._v(" 3.3 Sentry")]),r._v(" "),t("p",[r._v("参见 "),t("a",{attrs:{href:"https://www.iocoder.cn/Sentry/install/?yudao",target:"_blank",rel:"noopener noreferrer"}},[r._v("《Sentry 极简入门 》 "),t("OutboundLink")],1),r._v("文章。")])])}),[],!1,null,null,null);t.default=n.exports},823:function(r,t,a){r.exports=a.p+"assets/img/img_35.45ad30b1.png"},824:function(r,t,a){r.exports=a.p+"assets/img/img_36.3da71e65.png"},825:function(r,t,a){r.exports=a.p+"assets/img/img_37.30afb57f.png"},826:function(r,t,a){r.exports=a.p+"assets/img/img_38.9f113d05.png"},827:function(r,t,a){r.exports=a.p+"assets/img/img_39.eafd9dc4.png"},828:function(r,t,a){r.exports=a.p+"assets/img/img_40.9482b2c3.png"},829:function(r,t,a){r.exports=a.p+"assets/img/img_41.b82af6f4.png"},830:function(r,t,a){r.exports=a.p+"assets/img/img_42.99f9e6b7.png"},831:function(r,t,a){r.exports=a.p+"assets/img/img_43.7b854b4d.png"}}]);