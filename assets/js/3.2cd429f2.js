(window.webpackJsonp=window.webpackJsonp||[]).push([[3],{1219:function(t,s,a){"use strict";a.r(s);var e=a(4),r=Object(e.a)({},(function(){var t=this,s=t._self._c;return s("ContentSlotsDistributor",{attrs:{"slot-key":t.$parent.slotKey}},[s("h1",{attrs:{id:"工作流-flowable-会签、或签"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#工作流-flowable-会签、或签"}},[t._v("#")]),t._v(" 工作流（Flowable）会签、或签")]),t._v(" "),s("p",[t._v("项目基于 Flowable 实现了工作流的功能。本章节，我们将介绍工作流的相关功能。")]),t._v(" "),s("p",[t._v("以请假流程为例，讲解系统支持的两种表单方式的工作流：")]),t._v(" "),s("ol",[s("li",[t._v("流程表单：在线配置动态表单，无需建表与开发")]),t._v(" "),s("li",[t._v("业务表单：业务需建立独立的数据库表，并开发对应的表单、详情界面")])]),t._v(" "),s("p",[t._v("整个过程包括：")]),t._v(" "),s("ol",[s("li",[t._v("定义流程：【管理员】新建流程、设计流程模型、并设置用户任务的审批人，最终发布流程")]),t._v(" "),s("li",[t._v("发起流程：【员工】选择流程，并发起流程实例")]),t._v(" "),s("li",[t._v("审批流程：【审批人】接收到流程任务，审批结果为通过或不通过")])]),t._v(" "),s("img",{attrs:{src:a(688)}}),t._v(" "),s("p",[t._v("微信扫描下方二维码，加入后可观看视频！")]),t._v(" "),s("img",{attrs:{src:a(689)}}),t._v(" "),s("ul",[s("li",[s("a",{attrs:{href:"https://t.zsxq.com/04aqfIiY3",target:"_blank",rel:"noopener noreferrer"}},[t._v("01、如何集成 Flowable 框架？"),s("OutboundLink")],1)]),t._v(" "),s("li",[s("a",{attrs:{href:"https://t.zsxq.com/04nun2RRz",target:"_blank",rel:"noopener noreferrer"}},[t._v("02、如何实现动态的流程表单？"),s("OutboundLink")],1)]),t._v(" "),s("li",[s("a",{attrs:{href:"https://t.zsxq.com/04uneeaUb",target:"_blank",rel:"noopener noreferrer"}},[t._v("03、如何实现流程表单的保存？"),s("OutboundLink")],1)]),t._v(" "),s("li",[s("a",{attrs:{href:"https://t.zsxq.com/04jiMrjAm",target:"_blank",rel:"noopener noreferrer"}},[t._v("04、如何实现流程表单的展示？"),s("OutboundLink")],1)]),t._v(" "),s("li",[s("a",{attrs:{href:"https://t.zsxq.com/04iynUF6e",target:"_blank",rel:"noopener noreferrer"}},[t._v("05、如何实现流程模型的新建？"),s("OutboundLink")],1)]),t._v(" "),s("li",[s("a",{attrs:{href:"https://t.zsxq.com/04rNVbEQB",target:"_blank",rel:"noopener noreferrer"}},[t._v("06、如何实现流程模型的流程图的设计？"),s("OutboundLink")],1)]),t._v(" "),s("li",[s("a",{attrs:{href:"https://t.zsxq.com/042neybYz",target:"_blank",rel:"noopener noreferrer"}},[t._v("07、如何实现流程模型的流程图的预览？"),s("OutboundLink")],1)]),t._v(" "),s("li",[s("a",{attrs:{href:"https://t.zsxq.com/04uburRvZ",target:"_blank",rel:"noopener noreferrer"}},[t._v("08、如何实现流程模型的分配规则？"),s("OutboundLink")],1)]),t._v(" "),s("li",[s("a",{attrs:{href:"https://t.zsxq.com/04jUBMjyF",target:"_blank",rel:"noopener noreferrer"}},[t._v("09、如何实现流程模型的发布？"),s("OutboundLink")],1)]),t._v(" "),s("li",[s("a",{attrs:{href:"https://t.zsxq.com/04MF6URvz",target:"_blank",rel:"noopener noreferrer"}},[t._v("10、如何实现流程定义的查询？"),s("OutboundLink")],1)]),t._v(" "),s("li",[s("a",{attrs:{href:"https://t.zsxq.com/04jyvNfqj",target:"_blank",rel:"noopener noreferrer"}},[t._v("11、如何实现流程的发起？"),s("OutboundLink")],1)]),t._v(" "),s("li",[s("a",{attrs:{href:"https://t.zsxq.com/046UFqRzz",target:"_blank",rel:"noopener noreferrer"}},[t._v("12、如何实现我的流程列表？"),s("OutboundLink")],1)]),t._v(" "),s("li",[s("a",{attrs:{href:"https://t.zsxq.com/04aM72rzv",target:"_blank",rel:"noopener noreferrer"}},[t._v("13、如何实现流程的取消？"),s("OutboundLink")],1)]),t._v(" "),s("li",[s("a",{attrs:{href:"https://t.zsxq.com/04rNvFI2f",target:"_blank",rel:"noopener noreferrer"}},[t._v("14、如何实现流程的任务分配？"),s("OutboundLink")],1)]),t._v(" "),s("li",[s("a",{attrs:{href:"https://t.zsxq.com/04yFUVZvF",target:"_blank",rel:"noopener noreferrer"}},[t._v("15、如何实现会签、或签任务？"),s("OutboundLink")],1)]),t._v(" "),s("li",[s("a",{attrs:{href:"https://t.zsxq.com/04QZzjAme",target:"_blank",rel:"noopener noreferrer"}},[t._v("16、如何实现我的待办任务列表？"),s("OutboundLink")],1)]),t._v(" "),s("li",[s("a",{attrs:{href:"https://t.zsxq.com/04uj6AQJE",target:"_blank",rel:"noopener noreferrer"}},[t._v("17、如何实现我的已办任务列表？"),s("OutboundLink")],1)]),t._v(" "),s("li",[s("a",{attrs:{href:"https://t.zsxq.com/04Q7UbqBM",target:"_blank",rel:"noopener noreferrer"}},[t._v("18、如何实现任务的审批通过？"),s("OutboundLink")],1)]),t._v(" "),s("li",[s("a",{attrs:{href:"https://t.zsxq.com/04BQvJM7y",target:"_blank",rel:"noopener noreferrer"}},[t._v("19、如何实现任务的审批不通过？"),s("OutboundLink")],1)]),t._v(" "),s("li",[s("a",{attrs:{href:"https://t.zsxq.com/04Ie2v7m2",target:"_blank",rel:"noopener noreferrer"}},[t._v("20、如何实现流程的审批记录？"),s("OutboundLink")],1)]),t._v(" "),s("li",[s("a",{attrs:{href:"https://t.zsxq.com/04R72rzzN",target:"_blank",rel:"noopener noreferrer"}},[t._v("21、如何实现流程的流程图的高亮？"),s("OutboundLink")],1)]),t._v(" "),s("li",[s("a",{attrs:{href:"https://t.zsxq.com/04eyRRJ2f",target:"_blank",rel:"noopener noreferrer"}},[t._v("22、如何实现工作流的短信通知？"),s("OutboundLink")],1)]),t._v(" "),s("li",[s("a",{attrs:{href:"https://t.zsxq.com/04rFUjIei",target:"_blank",rel:"noopener noreferrer"}},[t._v("23、如何实现 OA 请假的发起？"),s("OutboundLink")],1)]),t._v(" "),s("li",[s("a",{attrs:{href:"https://t.zsxq.com/04fMJiufQ",target:"_blank",rel:"noopener noreferrer"}},[t._v("24、如何实现 OA 请假的审批？"),s("OutboundLink")],1)])]),t._v(" "),s("h2",{attrs:{id:"_0-如何开启-bpm-模块"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#_0-如何开启-bpm-模块"}},[t._v("#")]),t._v(" 0. 如何开启 bpm 模块？")]),t._v(" "),s("p",[s("code",[t._v("yudao-module-bpm")]),t._v(" 模块默认未启用，需要手动开启。步骤如下：")]),t._v(" "),s("p",[t._v("① 第一步，修改根目录的 "),s("a",{attrs:{href:"https://github.com/YunaiV/ruoyi-vue-pro/blob/master/pom.xml",target:"_blank",rel:"noopener noreferrer"}},[s("code",[t._v("pom.xml")]),t._v(" "),s("OutboundLink")],1),t._v("文件，取消 "),s("code",[t._v("yudao-module-bpm")]),t._v(" 模块的注释。")]),t._v(" "),s("img",{attrs:{src:a(690)}}),t._v(" "),s("p",[t._v("① 第二步，修改 "),s("code",[t._v("yudao-server")]),t._v(" 的 "),s("a",{attrs:{href:"https://github.com/YunaiV/ruoyi-vue-pro/blob/master/yudao-server/pom.xml",target:"_blank",rel:"noopener noreferrer"}},[s("code",[t._v("pom.xml")]),t._v(" "),s("OutboundLink")],1),t._v("文件，取消 "),s("code",[t._v("yudao-module-bpm-biz")]),t._v(" 依赖的注释，并进行 IDEA 的 Maven 刷新。")]),t._v(" "),s("img",{attrs:{src:a(691)}}),t._v(" "),s("p",[t._v("③ 第三步，重启项目，看到 "),s("code",[t._v("Property Source flowable-liquibase-override refreshed")]),t._v(" 说明开启成功。")]),t._v(" "),s("p",[t._v("另外，启动过程中，Flowable 会自动创建 "),s("code",[t._v("ACT_")]),t._v(" 和 "),s("code",[t._v("FLW_")]),t._v(" 开头的表。")]),t._v(" "),s("p",[t._v("如果启动中报 "),s("a",{attrs:{href:"https://gitee.com/zhijiantianya/ruoyi-vue-pro/issues/I57FYM",target:"_blank",rel:"noopener noreferrer"}},[t._v("MySQL “Specified key was too long; max key length is 1000 bytes” "),s("OutboundLink")],1),t._v("错误，可以将 MySQL 的缺省存储引擎设置为 innodb，即 "),s("code",[t._v("default-storage-engine=innodb")]),t._v(" 配置项。")]),t._v(" "),s("h2",{attrs:{id:"_1-请假流程【流程表单】"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#_1-请假流程【流程表单】"}},[t._v("#")]),t._v(" 1. 请假流程【流程表单】")]),t._v(" "),s("h3",{attrs:{id:"_1-1-第一步-定义流程"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#_1-1-第一步-定义流程"}},[t._v("#")]),t._v(" 1.1 第一步：定义流程")]),t._v(" "),s("p",[t._v("登录账号 admin、密码 admin123 的用户，扮演【管理员】的角色，进行流程的定义。")]),t._v(" "),s("p",[t._v("① 访问 [工作流程 -> 流程管理 -> 流程模型] 菜单，点击 [新建流程] 按钮，填写流程标识、流程名称。如下图所示：")]),t._v(" "),s("img",{attrs:{src:a(692)}}),t._v(" "),s("ul",[s("li",[t._v("流程标识：对应 BPMN 流程文件 XML 的 "),s("code",[t._v("id")]),t._v(" 属性，不能重复，新建后不可修改。")]),t._v(" "),s("li",[t._v("流程名称：对应 BPMN 流程文件 XML 的 "),s("code",[t._v("name")]),t._v(" 属性。")])]),t._v(" "),s("div",{staticClass:"language-xml line-numbers-mode"},[s("pre",{pre:!0,attrs:{class:"language-xml"}},[s("code",[s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("\x3c!-- 这是一个 BPMN XML 的示例，主要看 id 和 name 属性 --\x3e")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token prolog"}},[t._v('<?xml version="1.0" encoding="UTF-8"?>')]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token tag"}},[s("span",{pre:!0,attrs:{class:"token tag"}},[s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("<")]),s("span",{pre:!0,attrs:{class:"token namespace"}},[t._v("bpmn2:")]),t._v("definitions")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token attr-name"}},[s("span",{pre:!0,attrs:{class:"token namespace"}},[t._v("xmlns:")]),t._v("xsi")]),s("span",{pre:!0,attrs:{class:"token attr-value"}},[s("span",{pre:!0,attrs:{class:"token punctuation attr-equals"}},[t._v("=")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v('"')]),t._v("http://www.w3.org/2001/XMLSchema-instance"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v('"')])]),t._v(" "),s("span",{pre:!0,attrs:{class:"token attr-name"}},[s("span",{pre:!0,attrs:{class:"token namespace"}},[t._v("xmlns:")]),t._v("bpmn2")]),s("span",{pre:!0,attrs:{class:"token attr-value"}},[s("span",{pre:!0,attrs:{class:"token punctuation attr-equals"}},[t._v("=")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v('"')]),t._v("http://www.omg.org/spec/BPMN/20100524/MODEL"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v('"')])]),t._v(" "),s("span",{pre:!0,attrs:{class:"token attr-name"}},[s("span",{pre:!0,attrs:{class:"token namespace"}},[t._v("xmlns:")]),t._v("bpmndi")]),s("span",{pre:!0,attrs:{class:"token attr-value"}},[s("span",{pre:!0,attrs:{class:"token punctuation attr-equals"}},[t._v("=")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v('"')]),t._v("http://www.omg.org/spec/BPMN/20100524/DI"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v('"')])]),t._v(" "),s("span",{pre:!0,attrs:{class:"token attr-name"}},[t._v("id")]),s("span",{pre:!0,attrs:{class:"token attr-value"}},[s("span",{pre:!0,attrs:{class:"token punctuation attr-equals"}},[t._v("=")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v('"')]),t._v("diagram_Process_1647305370393"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v('"')])]),t._v(" "),s("span",{pre:!0,attrs:{class:"token attr-name"}},[t._v("targetNamespace")]),s("span",{pre:!0,attrs:{class:"token attr-value"}},[s("span",{pre:!0,attrs:{class:"token punctuation attr-equals"}},[t._v("=")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v('"')]),t._v("http://activiti.org/bpmn"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v('"')])]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v("\n  "),s("span",{pre:!0,attrs:{class:"token tag"}},[s("span",{pre:!0,attrs:{class:"token tag"}},[s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("<")]),s("span",{pre:!0,attrs:{class:"token namespace"}},[t._v("bpmn2:")]),t._v("process")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token attr-name"}},[t._v("id")]),s("span",{pre:!0,attrs:{class:"token attr-value"}},[s("span",{pre:!0,attrs:{class:"token punctuation attr-equals"}},[t._v("=")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v('"')]),t._v("common-form"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v('"')])]),t._v(" "),s("span",{pre:!0,attrs:{class:"token attr-name"}},[t._v("name")]),s("span",{pre:!0,attrs:{class:"token attr-value"}},[s("span",{pre:!0,attrs:{class:"token punctuation attr-equals"}},[t._v("=")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v('"')]),t._v("通用表单流程"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v('"')])]),t._v(" "),s("span",{pre:!0,attrs:{class:"token attr-name"}},[t._v("isExecutable")]),s("span",{pre:!0,attrs:{class:"token attr-value"}},[s("span",{pre:!0,attrs:{class:"token punctuation attr-equals"}},[t._v("=")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v('"')]),t._v("true"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v('"')])]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("/>")])]),t._v("\n  "),s("span",{pre:!0,attrs:{class:"token tag"}},[s("span",{pre:!0,attrs:{class:"token tag"}},[s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("<")]),s("span",{pre:!0,attrs:{class:"token namespace"}},[t._v("bpmndi:")]),t._v("BPMNDiagram")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token attr-name"}},[t._v("id")]),s("span",{pre:!0,attrs:{class:"token attr-value"}},[s("span",{pre:!0,attrs:{class:"token punctuation attr-equals"}},[t._v("=")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v('"')]),t._v("BPMNDiagram_1"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v('"')])]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token tag"}},[s("span",{pre:!0,attrs:{class:"token tag"}},[s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("<")]),s("span",{pre:!0,attrs:{class:"token namespace"}},[t._v("bpmndi:")]),t._v("BPMNPlane")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token attr-name"}},[t._v("id")]),s("span",{pre:!0,attrs:{class:"token attr-value"}},[s("span",{pre:!0,attrs:{class:"token punctuation attr-equals"}},[t._v("=")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v('"')]),t._v("common-form_di"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v('"')])]),t._v(" "),s("span",{pre:!0,attrs:{class:"token attr-name"}},[t._v("bpmnElement")]),s("span",{pre:!0,attrs:{class:"token attr-value"}},[s("span",{pre:!0,attrs:{class:"token punctuation attr-equals"}},[t._v("=")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v('"')]),t._v("common-form"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v('"')])]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("/>")])]),t._v("\n  "),s("span",{pre:!0,attrs:{class:"token tag"}},[s("span",{pre:!0,attrs:{class:"token tag"}},[s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("</")]),s("span",{pre:!0,attrs:{class:"token namespace"}},[t._v("bpmndi:")]),t._v("BPMNDiagram")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token tag"}},[s("span",{pre:!0,attrs:{class:"token tag"}},[s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("</")]),s("span",{pre:!0,attrs:{class:"token namespace"}},[t._v("bpmn2:")]),t._v("definitions")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v("\n")])]),t._v(" "),s("div",{staticClass:"line-numbers-wrapper"},[s("span",{staticClass:"line-number"},[t._v("1")]),s("br"),s("span",{staticClass:"line-number"},[t._v("2")]),s("br"),s("span",{staticClass:"line-number"},[t._v("3")]),s("br"),s("span",{staticClass:"line-number"},[t._v("4")]),s("br"),s("span",{staticClass:"line-number"},[t._v("5")]),s("br"),s("span",{staticClass:"line-number"},[t._v("6")]),s("br"),s("span",{staticClass:"line-number"},[t._v("7")]),s("br"),s("span",{staticClass:"line-number"},[t._v("8")]),s("br")])]),s("p",[t._v("② 访问 [工作流程 -> 流程管理 -> 流程表单] 菜单，点击 [新增] 按钮，新增一个名字为 leave-form 的表单。如下图所示：")]),t._v(" "),s("img",{attrs:{src:a(693)}}),t._v(" "),s("p",[t._v("流程表单的实现？")]),t._v(" "),s("p",[t._v("基于 "),s("a",{attrs:{href:"https://github.com/JakHuang/form-generator",target:"_blank",rel:"noopener noreferrer"}},[t._v("https://github.com/JakHuang/form-generator "),s("OutboundLink")],1),t._v("项目实现的动态表单。")]),t._v(" "),s("p",[t._v("回到 [工作流程 -> 流程管理 -> 流程模型] 菜单，点击 [修改流程] 按钮，配置表单类型为流程表单，选择名字为 leave-form 的流程表单。如下图所示：")]),t._v(" "),s("img",{attrs:{src:a(694)}}),t._v(" "),s("p",[t._v("③ 点击 [设计流程] 按钮，在线设计请假流程模型，包含两个用户任务：领导审批、HR 审批。如下图所示：")]),t._v(" "),s("img",{attrs:{src:a(695)}}),t._v(" "),s("p",[t._v("设计流程的实现？")]),t._v(" "),s("p",[t._v("基于 "),s("a",{attrs:{href:"https://github.com/miyuesc/bpmn-process-designer",target:"_blank",rel:"noopener noreferrer"}},[t._v("https://github.com/miyuesc/bpmn-process-designer "),s("OutboundLink")],1),t._v("项目实现，它的底层是 "),s("a",{attrs:{href:"https://github.com/bpmn-io",target:"_blank",rel:"noopener noreferrer"}},[t._v("bpmn-js "),s("OutboundLink")],1),t._v("。")]),t._v(" "),s("p",[t._v("④ 点击 [分配规则] 按钮，设置用户任务的审批人。其中，规则类型用于分配用户任务的审批人，目前有 7 种规则：角色、部门成员、部门负责人、岗位、用户、用户组、自定义脚本，基本可以满足绝大多数场景，是不是非常良心。")]),t._v(" "),s("ul",[s("li",[t._v("设置【领导审批】的规则类型为自定义脚本 + 流程发起人的一级领导，如下图所示： "),s("img",{attrs:{src:a(696)}})]),t._v(" "),s("li",[t._v("设置【HR 审批】的规则类型为岗位 + 人力资源，如下图所示： "),s("img",{attrs:{src:a(697)}})])]),t._v(" "),s("p",[t._v("规则类型的实现？")]),t._v(" "),s("p",[t._v("可见 "),s("a",{attrs:{href:"https://github.com/YunaiV/ruoyi-vue-pro/blob/master/yudao-module-bpm/yudao-module-bpm-biz/src/main/java/cn/iocoder/yudao/module/bpm/framework/flowable/core/behavior/BpmUserTaskActivityBehavior.java",target:"_blank",rel:"noopener noreferrer"}},[t._v("BpmUserTaskActivityBehavior "),s("OutboundLink")],1),t._v("代码，目前暂时支持分配一个审批人。")]),t._v(" "),s("p",[t._v("⑤ 点击 [发布流程] 按钮，把定义的流程模型部署出去。部署成功后，就可以发起该流程了。如下图所示：")]),t._v(" "),s("img",{attrs:{src:a(698)}}),t._v(" "),s("p",[t._v("修改流程后，需要重新发布流程吗？")]),t._v(" "),s("p",[t._v("需要，"),s("strong",[t._v("必须重新发布")]),t._v("才能生效。每次流程发布后，会生成一个新的流程定义，版本号从 v1 开始递增。")]),t._v(" "),s("p",[t._v("发布成功后，会部署新版本的流程定义，旧版本的流程定义将被挂起。当然，已经发起的流程不会受到影响，还是走老的流程定义。")]),t._v(" "),s("h3",{attrs:{id:"_1-2-第二步-发起流程"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#_1-2-第二步-发起流程"}},[t._v("#")]),t._v(" 1.2 第二步：发起流程")]),t._v(" "),s("p",[t._v("登录账号 admin、密码 admin123 的用户，扮演【员工】的角色，进行流程的发起。")]),t._v(" "),s("p",[t._v("① 访问 [工作流程 -> 任务管理 -> 我的流程] 菜单，点击 [发起流程] 按钮，可以看到可以选择的流程定义的列表。")]),t._v(" "),s("img",{attrs:{src:a(699)}}),t._v(" "),s("p",[t._v("② 选择名字为通用表单的流程定义，发起请假流程。填写请假表单信息如下：")]),t._v(" "),s("img",{attrs:{src:a(700)}}),t._v(" "),s("p",[t._v("③ 点击提交成功后，可在我的流程中，可看到该流程的状态、结果。")]),t._v(" "),s("img",{attrs:{src:a(701)}}),t._v(" "),s("p",[t._v("④ 点击 [详情] 按钮，可以查看申请的表单信息、审批记录、流程跟踪图。")]),t._v(" "),s("img",{attrs:{src:a(702)}}),t._v(" "),s("h3",{attrs:{id:"_1-2-第三步-审批流程-领导审批"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#_1-2-第三步-审批流程-领导审批"}},[t._v("#")]),t._v(" 1.2 第三步：审批流程（领导审批）")]),t._v(" "),s("p",[t._v("登录账号 test、密码 test123 的用户，扮演【审批人】的角色，进行请假流程的【领导审批】任务。")]),t._v(" "),s("p",[t._v("① 访问 [工作流程 -> 任务管理 -> 待办任务] 菜单，可以查询到需要审批的任务。")]),t._v(" "),s("img",{attrs:{src:a(703)}}),t._v(" "),s("p",[t._v("② 点击 [审批] 按钮，填写审批建议，并点击 [通过] 按钮，这样任务的审批就完成了。")]),t._v(" "),s("img",{attrs:{src:a(704)}}),t._v(" "),s("p",[t._v("③ 访问 [工作流程 -> 任务管理 -> 已办任务] 菜单，可以查询到已经审批的任务。")]),t._v(" "),s("img",{attrs:{src:a(705)}}),t._v(" "),s("hr"),t._v(" "),s("p",[t._v("此时，使用【员工】的角色，访问 [工作流程 -> 任务管理 -> 我的流程] 菜单，可以看到流程流转到了【HR 审批】任务。")]),t._v(" "),s("img",{attrs:{src:a(706)}}),t._v(" "),s("h3",{attrs:{id:"_1-3-第三步-审批流程-hr-审批"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#_1-3-第三步-审批流程-hr-审批"}},[t._v("#")]),t._v(" 1.3 第三步：审批流程（HR 审批）")]),t._v(" "),s("p",[t._v("登录账号 hrmgr、密码 hr123 的用户，扮演【审批人】的角色，进行请假流程的【HR 审批】任务。")]),t._v(" "),s("p",[t._v("① 访问 [工作流程 -> 任务管理 -> 待办任务] 菜单，点击 [审批] 按钮，填写审批建议，并点击 [通过] 按钮。")]),t._v(" "),s("hr"),t._v(" "),s("p",[t._v("此时，使用【员工】的角色，访问 [工作流程 -> 任务管理 -> 我的流程] 菜单，可以看到流程处理结束，最终审批通过。")]),t._v(" "),s("img",{attrs:{src:a(707)}}),t._v(" "),s("h2",{attrs:{id:"_2-请假流程【业务表单】"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#_2-请假流程【业务表单】"}},[t._v("#")]),t._v(" 2. 请假流程【业务表单】")]),t._v(" "),s("p",[t._v("根据业务需要，业务通过建立独立的数据库表（业务表）记录申请信息，而流程引擎只负责推动流程的前进或者结束。两者需要进行"),s("strong",[t._v("双向")]),t._v("的关联：")]),t._v(" "),s("ul",[s("li",[t._v("每一条业务表记录，通过它的流程实例的编号( "),s("code",[t._v("process_instance_id")]),t._v(" )指向对应的流程实例")]),t._v(" "),s("li",[t._v("每一个流程实例，通过它的业务键( "),s("code",[t._v("BUSINESS_KEY_")]),t._v(" ) 指向对应的业务表记录。")])]),t._v(" "),s("p",[t._v("以项目中提供的 "),s("a",{attrs:{href:"https://github.com/YunaiV/ruoyi-vue-pro/blob/master/yudao-module-bpm/yudao-module-bpm-biz/src/main/java/cn/iocoder/yudao/module/bpm/service/oa/BpmOALeaveServiceImpl.java",target:"_blank",rel:"noopener noreferrer"}},[t._v("OALeave "),s("OutboundLink")],1),t._v("请假举例子，它的业务表 "),s("code",[t._v("bpm_oa_leave")]),t._v(" 和流程引擎的流程实例的关系如下图：")]),t._v(" "),s("img",{attrs:{src:a(708)}}),t._v(" "),s("p",[t._v("也因为业务建立了独立的业务表，所以必须开发业务表对应的列表、表单、详情页面。不过，审核相关的功能是无需重新开发的，原因是业务表已经关联对应的流程实例，流程引擎审批流程实例即可。")]),t._v(" "),s("p",[t._v("下面，我们以项目中的 "),s("a",{attrs:{href:"https://github.com/YunaiV/ruoyi-vue-pro/blob/master/yudao-module-bpm/yudao-module-bpm-biz/src/main/java/cn/iocoder/yudao/module/bpm/service/oa/BpmOALeaveServiceImpl.java",target:"_blank",rel:"noopener noreferrer"}},[t._v("OALeave "),s("OutboundLink")],1),t._v("为例子，详细讲解下业务表单的开发与使用的过程。")]),t._v(" "),s("h3",{attrs:{id:"_2-0-第零步-业务开发"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#_2-0-第零步-业务开发"}},[t._v("#")]),t._v(" 2.0 第零步：业务开发")]),t._v(" "),s("p",[t._v("① 新建业务表 "),s("code",[t._v("bpm_oa_leave")]),t._v("，建表语句如下：")]),t._v(" "),s("div",{staticClass:"language-sql line-numbers-mode"},[s("pre",{pre:!0,attrs:{class:"language-sql"}},[s("code",[s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("CREATE")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("TABLE")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token identifier"}},[s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("`")]),t._v("bpm_oa_leave"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("`")])]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("\n  "),s("span",{pre:!0,attrs:{class:"token identifier"}},[s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("`")]),t._v("id"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("`")])]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("bigint")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("NOT")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token boolean"}},[t._v("NULL")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("AUTO_INCREMENT")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("COMMENT")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'请假表单主键'")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n  "),s("span",{pre:!0,attrs:{class:"token identifier"}},[s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("`")]),t._v("user_id"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("`")])]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("bigint")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("NOT")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token boolean"}},[t._v("NULL")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("COMMENT")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'申请人的用户编号'")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n  "),s("span",{pre:!0,attrs:{class:"token identifier"}},[s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("`")]),t._v("type"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("`")])]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("tinyint")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("NOT")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token boolean"}},[t._v("NULL")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("COMMENT")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'请假类型'")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n  "),s("span",{pre:!0,attrs:{class:"token identifier"}},[s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("`")]),t._v("reason"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("`")])]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("varchar")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("200")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("CHARACTER")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("SET")]),t._v(" utf8mb4 "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("COLLATE")]),t._v(" utf8mb4_unicode_ci "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("NOT")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token boolean"}},[t._v("NULL")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("COMMENT")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'请假原因'")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n  "),s("span",{pre:!0,attrs:{class:"token identifier"}},[s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("`")]),t._v("start_time"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("`")])]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("datetime")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("NOT")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token boolean"}},[t._v("NULL")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("COMMENT")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'开始时间'")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n  "),s("span",{pre:!0,attrs:{class:"token identifier"}},[s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("`")]),t._v("end_time"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("`")])]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("datetime")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("NOT")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token boolean"}},[t._v("NULL")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("COMMENT")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'结束时间'")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n  "),s("span",{pre:!0,attrs:{class:"token identifier"}},[s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("`")]),t._v("day"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("`")])]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("tinyint")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("NOT")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token boolean"}},[t._v("NULL")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("COMMENT")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'请假天数'")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n  "),s("span",{pre:!0,attrs:{class:"token identifier"}},[s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("`")]),t._v("result"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("`")])]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("tinyint")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("NOT")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token boolean"}},[t._v("NULL")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("COMMENT")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'请假结果'")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n  "),s("span",{pre:!0,attrs:{class:"token identifier"}},[s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("`")]),t._v("process_instance_id"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("`")])]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("varchar")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("64")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("CHARACTER")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("SET")]),t._v(" utf8mb4 "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("COLLATE")]),t._v(" utf8mb4_unicode_ci "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("DEFAULT")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token boolean"}},[t._v("NULL")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("COMMENT")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'流程实例的编号'")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n  "),s("span",{pre:!0,attrs:{class:"token identifier"}},[s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("`")]),t._v("creator"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("`")])]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("varchar")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("64")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("CHARACTER")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("SET")]),t._v(" utf8mb4 "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("COLLATE")]),t._v(" utf8mb4_unicode_ci "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("DEFAULT")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("''")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("COMMENT")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'创建者'")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n  "),s("span",{pre:!0,attrs:{class:"token identifier"}},[s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("`")]),t._v("create_time"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("`")])]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("datetime")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("NOT")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token boolean"}},[t._v("NULL")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("DEFAULT")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("CURRENT_TIMESTAMP")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("COMMENT")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'创建时间'")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n  "),s("span",{pre:!0,attrs:{class:"token identifier"}},[s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("`")]),t._v("updater"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("`")])]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("varchar")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("64")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("CHARACTER")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("SET")]),t._v(" utf8mb4 "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("COLLATE")]),t._v(" utf8mb4_unicode_ci "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("DEFAULT")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("''")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("COMMENT")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'更新者'")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n  "),s("span",{pre:!0,attrs:{class:"token identifier"}},[s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("`")]),t._v("update_time"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("`")])]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("datetime")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("NOT")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token boolean"}},[t._v("NULL")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("DEFAULT")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("CURRENT_TIMESTAMP")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("ON")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("UPDATE")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("CURRENT_TIMESTAMP")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("COMMENT")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'更新时间'")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n  "),s("span",{pre:!0,attrs:{class:"token identifier"}},[s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("`")]),t._v("deleted"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("`")])]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("bit")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("1")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("NOT")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token boolean"}},[t._v("NULL")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("DEFAULT")]),t._v(" b"),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'0'")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("COMMENT")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'是否删除'")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n  "),s("span",{pre:!0,attrs:{class:"token identifier"}},[s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("`")]),t._v("tenant_id"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("`")])]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("bigint")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("NOT")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token boolean"}},[t._v("NULL")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("DEFAULT")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'0'")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("COMMENT")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'租户编号'")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n  "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("PRIMARY")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("KEY")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token identifier"}},[s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("`")]),t._v("id"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("`")])]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("USING")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("BTREE")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("ENGINE")]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("InnoDB")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("AUTO_INCREMENT")]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("26")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("DEFAULT")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("CHARSET")]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v("utf8mb4 "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("COLLATE")]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v("utf8mb4_unicode_ci "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("COMMENT")]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'OA 请假申请表'")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n")])]),t._v(" "),s("div",{staticClass:"line-numbers-wrapper"},[s("span",{staticClass:"line-number"},[t._v("1")]),s("br"),s("span",{staticClass:"line-number"},[t._v("2")]),s("br"),s("span",{staticClass:"line-number"},[t._v("3")]),s("br"),s("span",{staticClass:"line-number"},[t._v("4")]),s("br"),s("span",{staticClass:"line-number"},[t._v("5")]),s("br"),s("span",{staticClass:"line-number"},[t._v("6")]),s("br"),s("span",{staticClass:"line-number"},[t._v("7")]),s("br"),s("span",{staticClass:"line-number"},[t._v("8")]),s("br"),s("span",{staticClass:"line-number"},[t._v("9")]),s("br"),s("span",{staticClass:"line-number"},[t._v("10")]),s("br"),s("span",{staticClass:"line-number"},[t._v("11")]),s("br"),s("span",{staticClass:"line-number"},[t._v("12")]),s("br"),s("span",{staticClass:"line-number"},[t._v("13")]),s("br"),s("span",{staticClass:"line-number"},[t._v("14")]),s("br"),s("span",{staticClass:"line-number"},[t._v("15")]),s("br"),s("span",{staticClass:"line-number"},[t._v("16")]),s("br"),s("span",{staticClass:"line-number"},[t._v("17")]),s("br"),s("span",{staticClass:"line-number"},[t._v("18")]),s("br")])]),s("ul",[s("li",[s("code",[t._v("process_instance_id")]),t._v(" 字段，关联流程引擎的流程实例对应的 "),s("code",[t._v("ACT_HI_PROCINST")]),t._v(" 表的 "),s("code",[t._v("PROC_INST_ID_")]),t._v(" 字段")]),t._v(" "),s("li",[s("code",[t._v("result")]),t._v(" 字段，请假结果，需要通过 Listener 监听回调结果，稍后来看看")])]),t._v(" "),s("p",[t._v("② 实现业务表的【后端】业务逻辑，具体代码可以看看如下两个类：")]),t._v(" "),s("ul",[s("li",[s("a",{attrs:{href:"https://github.com/YunaiV/ruoyi-vue-pro/blob/master/yudao-module-bpm/yudao-module-bpm-biz/src/main/java/cn/iocoder/yudao/module/bpm/controller/admin/oa/BpmOALeaveController.java",target:"_blank",rel:"noopener noreferrer"}},[t._v("BpmOALeaveController"),s("OutboundLink")],1)]),t._v(" "),s("li",[s("a",{attrs:{href:"https://github.com/YunaiV/ruoyi-vue-pro/blob/master/yudao-module-bpm/yudao-module-bpm-biz/src/main/java/cn/iocoder/yudao/module/bpm/service/oa/BpmOALeaveServiceImpl.java",target:"_blank",rel:"noopener noreferrer"}},[t._v("BpmOALeaveServiceImpl"),s("OutboundLink")],1)])]),t._v(" "),s("p",[t._v("重点是看流程发起的逻辑，它定义了 "),s("code",[t._v("/bpm/oa/leave/create")]),t._v(" 给业务的表单界面调用，UML 时序图如下：")]),t._v(" "),s("img",{attrs:{src:a(709)}}),t._v(" "),s("p",[t._v("具体的实现代码比较简单，如下图所示：")]),t._v(" "),s("img",{attrs:{src:a(710)}}),t._v(" "),s("ul",[s("li",[s("code",[t._v("PROCESS_KEY")]),t._v(" 静态变量：是业务对应的流程模型的编号，稍后会进行创建编号为 oa_leave 的流程模型。")]),t._v(" "),s("li",[s("a",{attrs:{href:"https://github.com/YunaiV/ruoyi-vue-pro/blob/master/yudao-module-bpm/yudao-module-bpm-api/src/main/java/cn/iocoder/yudao/module/bpm/api/task/BpmProcessInstanceApi.java",target:"_blank",rel:"noopener noreferrer"}},[t._v("BpmProcessInstanceApi "),s("OutboundLink")],1),t._v("定义了 "),s("code",[t._v("#createProcessInstance(...)")]),t._v(" 方法，用于创建流程实例，业务无需关心底层是 Activiti 还是 Flowable 引擎，甚至未来可能的 Camunda 引擎。")])]),t._v(" "),s("p",[t._v("③ 实现业务表的【前端】业务逻辑，具体代码可以看看如下三个页面：")]),t._v(" "),s("ul",[s("li",[s("a",{attrs:{href:"https://github.com/YunaiV/ruoyi-vue-pro/blob/master/yudao-ui-admin/src/views/bpm/oa/leave/create.vue",target:"_blank",rel:"noopener noreferrer"}},[s("code",[t._v("leave/create.vue")]),s("OutboundLink")],1)]),t._v(" "),s("li",[s("a",{attrs:{href:"https://github.com/YunaiV/ruoyi-vue-pro/blob/master/yudao-ui-admin/src/views/bpm/oa/leave/detail.vue",target:"_blank",rel:"noopener noreferrer"}},[s("code",[t._v("leave/detail.vue")]),s("OutboundLink")],1)]),t._v(" "),s("li",[s("a",{attrs:{href:"https://github.com/YunaiV/ruoyi-vue-pro/blob/master/yudao-ui-admin/src/views/bpm/oa/leave/index.vue",target:"_blank",rel:"noopener noreferrer"}},[s("code",[t._v("leave/index.vue")]),s("OutboundLink")],1)])]),t._v(" "),s("p",[t._v("另外，在 "),s("a",{attrs:{href:"https://github.com/YunaiV/ruoyi-vue-pro/blob/master/yudao-ui-admin/src/router/index.js",target:"_blank",rel:"noopener noreferrer"}},[s("code",[t._v("router/index.js")]),t._v(" "),s("OutboundLink")],1),t._v("中定义 "),s("code",[t._v("create.vue")]),t._v(" 和 "),s("code",[t._v("detail.vue")]),t._v(" 的路由，配置如下：")]),t._v(" "),s("div",{staticClass:"language-javascript line-numbers-mode"},[s("pre",{pre:!0,attrs:{class:"language-javascript"}},[s("code",[s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token literal-property property"}},[t._v("path")]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'/bpm'")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token literal-property property"}},[t._v("component")]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" Layout"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token literal-property property"}},[t._v("hidden")]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token boolean"}},[t._v("true")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token literal-property property"}},[t._v("redirect")]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'noredirect'")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token literal-property property"}},[t._v("children")]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n        "),s("span",{pre:!0,attrs:{class:"token literal-property property"}},[t._v("path")]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'oa/leave/create'")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n        "),s("span",{pre:!0,attrs:{class:"token function-variable function"}},[t._v("component")]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token parameter"}},[t._v("resolve")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=>")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("require")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'@/views/bpm/oa/leave/create'")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" resolve"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n        "),s("span",{pre:!0,attrs:{class:"token literal-property property"}},[t._v("name")]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'发起 OA 请假'")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n        "),s("span",{pre:!0,attrs:{class:"token literal-property property"}},[t._v("meta")]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),s("span",{pre:!0,attrs:{class:"token literal-property property"}},[t._v("title")]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'发起 OA 请假'")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token literal-property property"}},[t._v("icon")]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'form'")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token literal-property property"}},[t._v("activeMenu")]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'/bpm/oa/leave'")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n      "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n        "),s("span",{pre:!0,attrs:{class:"token literal-property property"}},[t._v("path")]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'oa/leave/detail'")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n        "),s("span",{pre:!0,attrs:{class:"token function-variable function"}},[t._v("component")]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token parameter"}},[t._v("resolve")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=>")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("require")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'@/views/bpm/oa/leave/detail'")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" resolve"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n        "),s("span",{pre:!0,attrs:{class:"token literal-property property"}},[t._v("name")]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'查看 OA 请假'")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n        "),s("span",{pre:!0,attrs:{class:"token literal-property property"}},[t._v("meta")]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),s("span",{pre:!0,attrs:{class:"token literal-property property"}},[t._v("title")]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'查看 OA 请假'")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token literal-property property"}},[t._v("icon")]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'view'")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token literal-property property"}},[t._v("activeMenu")]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'/bpm/oa/leave'")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n      "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n")])]),t._v(" "),s("div",{staticClass:"line-numbers-wrapper"},[s("span",{staticClass:"line-number"},[t._v("1")]),s("br"),s("span",{staticClass:"line-number"},[t._v("2")]),s("br"),s("span",{staticClass:"line-number"},[t._v("3")]),s("br"),s("span",{staticClass:"line-number"},[t._v("4")]),s("br"),s("span",{staticClass:"line-number"},[t._v("5")]),s("br"),s("span",{staticClass:"line-number"},[t._v("6")]),s("br"),s("span",{staticClass:"line-number"},[t._v("7")]),s("br"),s("span",{staticClass:"line-number"},[t._v("8")]),s("br"),s("span",{staticClass:"line-number"},[t._v("9")]),s("br"),s("span",{staticClass:"line-number"},[t._v("10")]),s("br"),s("span",{staticClass:"line-number"},[t._v("11")]),s("br"),s("span",{staticClass:"line-number"},[t._v("12")]),s("br"),s("span",{staticClass:"line-number"},[t._v("13")]),s("br"),s("span",{staticClass:"line-number"},[t._v("14")]),s("br"),s("span",{staticClass:"line-number"},[t._v("15")]),s("br"),s("span",{staticClass:"line-number"},[t._v("16")]),s("br"),s("span",{staticClass:"line-number"},[t._v("17")]),s("br"),s("span",{staticClass:"line-number"},[t._v("18")]),s("br")])]),s("p",[t._v("为什么要做独立的 "),s("code",[t._v("create.vue")]),t._v(" 和 "),s("code",[t._v("index.vue")]),t._v(" 页面？")]),t._v(" "),s("ul",[s("li",[t._v("创建流程时，需要跳转到 "),s("code",[t._v("create.vue")]),t._v(" 页面，填写业务表的信息，才能提交流程。")]),t._v(" "),s("li",[t._v("审批流程时，需要跳转到 "),s("code",[t._v("detail.vue")]),t._v(" 页面，查看业务表的信息。")])]),t._v(" "),s("p",[t._v("④ 实现业务表的【后端】监听逻辑，具体可见 "),s("a",{attrs:{href:"https://github.com/YunaiV/ruoyi-vue-pro/blob/master/yudao-module-bpm/yudao-module-bpm-biz/src/main/java/cn/iocoder/yudao/module/bpm/service/oa/listener/BpmOALeaveResultListener.java",target:"_blank",rel:"noopener noreferrer"}},[t._v("BpmOALeaveResultListener "),s("OutboundLink")],1),t._v("监听器。它实现流程引擎定义的 "),s("a",{attrs:{href:"https://github.com/YunaiV/ruoyi-vue-pro/blob/master/yudao-module-bpm/yudao-module-bpm-biz/src/main/java/cn/iocoder/yudao/module/bpm/framework/bpm/core/event/BpmProcessInstanceResultEventListener.java",target:"_blank",rel:"noopener noreferrer"}},[t._v("BpmProcessInstanceResultEventListener "),s("OutboundLink")],1),t._v("抽象类，在流程实例结束时，回调通知它"),s("strong",[t._v("最终的")]),t._v("结果是通过还是不通过。代码如下图：")]),t._v(" "),s("img",{attrs:{src:a(711)}}),t._v(" "),s("hr"),t._v(" "),s("p",[t._v("至此，我们了解了 OALeave 使用业务表单所涉及到的开发，下面我们来定义对应的流程、发起该流程、并审批该流程。")]),t._v(" "),s("h3",{attrs:{id:"_2-1-第一步-定义流程"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#_2-1-第一步-定义流程"}},[t._v("#")]),t._v(" 2.1 第一步：定义流程")]),t._v(" "),s("p",[t._v("登录账号 admin、密码 admin123 的用户，扮演【管理员】的角色，进行流程的定义。")]),t._v(" "),s("p",[t._v("① 访问 [工作流程 -> 流程管理 -> 流程模型] 菜单，点击 [新建流程] 按钮，填写流程标识、流程名称。如下图所示：")]),t._v(" "),s("img",{attrs:{src:a(712)}}),t._v(" "),s("p",[t._v("注意，流程标识需要填 oa_leave。因为在 BpmOALeaveServiceImpl 类中，规定了对应的流程标识为 oa_leave。")]),t._v(" "),s("p",[t._v("② 点击 [修改流程] 按钮，配置表单类型为业务表单，填写表单提交路由为 "),s("code",[t._v("/bpm/oa/leave/create")]),t._v("（用于发起流程时，跳转的业务表单的路由）、表单查看路由为 "),s("code",[t._v("/bpm/oa/leave/detail")]),t._v("（用于在流程详情中，点击查看表单的路由）。如下图所示：")]),t._v(" "),s("img",{attrs:{src:a(713)}}),t._v(" "),s("p",[t._v("③ 点击 [设计流程] 按钮，在线设计请假流程模型，包含两个用户任务：领导审批、HR 审批。如下图所示：")]),t._v(" "),s("img",{attrs:{src:a(714)}}),t._v(" "),s("p",[t._v("可以点击 "),s("a",{attrs:{href:"/img/jskz/%E8%8A%8B%E9%81%93%E6%BA%90%E7%A0%81/%E5%B7%A5%E4%BD%9C%E6%B5%81/oa_leave_bpmn.XML"}},[s("code",[t._v("oa_leave_bpmn.XML")])]),t._v(" 进行下载，然后点击 [打开文件] 按钮，进行导入。")]),t._v(" "),s("p",[t._v("④ 点击 [分配规则] 按钮，设置用户任务的审批人。")]),t._v(" "),s("ul",[s("li",[t._v("设置【领导审批】的规则类型为自定义脚本 + 流程发起人的一级领导，如下图所示： "),s("img",{attrs:{src:a(715)}})]),t._v(" "),s("li",[t._v("设置【HR 审批】的规则类型为岗位 + 人力资源，如下图所示： "),s("img",{attrs:{src:a(716)}})])]),t._v(" "),s("p",[t._v("⑤ 点击 [发布流程] 按钮，把定义的流程模型部署出去。部署成功后，就可以发起该流程了。")]),t._v(" "),s("h3",{attrs:{id:"_2-1-第二步-发起流程"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#_2-1-第二步-发起流程"}},[t._v("#")]),t._v(" 2.1 第二步：发起流程")]),t._v(" "),s("p",[t._v("登录账号 admin、密码 admin123 的用户，扮演【员工】的角色，进行流程的发起。")]),t._v(" "),s("p",[t._v("① 发起业务表单请假流程，两种路径：")]),t._v(" "),s("ol",[s("li",[t._v("访问 [工作流程 -> 任务管理 -> 我的流程] 菜单，点击 [发起流程] 按钮，会跳转到流程模型 oa_leave 配置的表单提交路由。 "),s("img",{attrs:{src:a(717)}})]),t._v(" "),s("li",[t._v("访问 [工作流程 -> 请假查询] 菜单，点击 [发起请假] 按钮。 "),s("img",{attrs:{src:a(718)}})])]),t._v(" "),s("p",[t._v("② 填写一个小于等于 3 天的请假，只会走【领导审批】任务；填写一个大于 3 天的请假，在走完【领导审批】任务后，会额外走【HR 审批】任务。")]),t._v(" "),s("p",[t._v("后续的流程，和「1. 请假流程【流程表单】」是基本一致的，这里就不重复赘述，当然你还是要试着跑一跑，了解整个的过程。")]),t._v(" "),s("h3",{attrs:{id:"_2-3-第三步-审批流程-领导审批"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#_2-3-第三步-审批流程-领导审批"}},[t._v("#")]),t._v(" 2.3 第三步：审批流程（领导审批）")]),t._v(" "),s("p",[t._v("略~自己跑")]),t._v(" "),s("h3",{attrs:{id:"_2-4-第三步-审批流程-hr-审批"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#_2-4-第三步-审批流程-hr-审批"}},[t._v("#")]),t._v(" 2.4 第三步：审批流程（HR 审批）")]),t._v(" "),s("p",[t._v("略~自己跑")]),t._v(" "),s("h2",{attrs:{id:"_2-流程通知"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#_2-流程通知"}},[t._v("#")]),t._v(" 2. 流程通知")]),t._v(" "),s("p",[t._v("流程在发生变化时，会发送通知给相关的人。目前有三个场景会有通知，通过短信的方式。")]),t._v(" "),s("img",{attrs:{src:a(719)}}),t._v(" "),s("h2",{attrs:{id:"_3-流程图示例"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#_3-流程图示例"}},[t._v("#")]),t._v(" 3. 流程图示例")]),t._v(" "),s("h3",{attrs:{id:"_3-1-会签"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#_3-1-会签"}},[t._v("#")]),t._v(" 3.1 会签")]),t._v(" "),s("p",[t._v("定义：指同一个审批节点设置多个人，如 ABC 三人，三人会同时收到审批，需全部同意之后，审批才可到下一审批节点。")]),t._v(" "),s("p",[t._v("配置方式如下图所示：")]),t._v(" "),s("img",{attrs:{src:a(720)}}),t._v(" "),s("p",[t._v("重点是【完成条件】为 "),s("code",[t._v("${ nrOfCompletedInstances== nrOfInstances }")]),t._v("。")]),t._v(" "),s("h3",{attrs:{id:"_3-2-或签"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#_3-2-或签"}},[t._v("#")]),t._v(" 3.2 或签")]),t._v(" "),s("p",[t._v("定义：指同一个审批节点设置多个人，如ABC三人，三人会同时收到审批，只要其中任意一人审批即可到下一审批节点。")]),t._v(" "),s("p",[t._v("配置方式如下图所示：")]),t._v(" "),s("img",{attrs:{src:a(721)}}),t._v(" "),s("p",[t._v("重点是【完成条件】为 "),s("code",[t._v("${ nrOfCompletedInstances== 1 }")]),t._v("。")]),t._v(" "),s("h2",{attrs:{id:"_4-如何使用-activiti"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#_4-如何使用-activiti"}},[t._v("#")]),t._v(" 4. 如何使用 Activiti？")]),t._v(" "),s("p",[t._v("Activiti 和 Flowable 提供的 Java API 是基本一致的，例如说 Flowable 的 "),s("code",[t._v("org.flowable.engine.RepositoryService")]),t._v(" 对应 Activiti 的 "),s("code",[t._v("org.activiti.engine .RepositoryService")]),t._v("。所以，我们可以修改 "),s("code",[t._v("import")]),t._v(" 的包路径来替换。")]),t._v(" "),s("p",[t._v("另外，在项目的老版本，我们也提供了 Activiti 实现，你可以具体参考下：")]),t._v(" "),s("ul",[s("li",[s("a",{attrs:{href:"https://gitee.com/zhijiantianya/ruoyi-vue-pro/tree/v1.6.2/yudao-framework/yudao-spring-boot-starter-activiti",target:"_blank",rel:"noopener noreferrer"}},[s("code",[t._v("yudao-spring-boot-starter-activiti")]),s("OutboundLink")],1)]),t._v(" "),s("li",[s("a",{attrs:{href:"https://gitee.com/zhijiantianya/ruoyi-vue-pro/tree/v1.6.2/yudao-module-bpm/yudao-module-bpm-biz-activiti",target:"_blank",rel:"noopener noreferrer"}},[s("code",[t._v("yudao-module-bpm-biz-activiti")]),s("OutboundLink")],1)])]),t._v(" "),s("img",{attrs:{src:a(722)}}),t._v(" "),s("h2",{attrs:{id:"_4-迭代计划"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#_4-迭代计划"}},[t._v("#")]),t._v(" 4. 迭代计划")]),t._v(" "),s("p",[t._v("工作流的基本功能已经开发完成，当然还是有很多功能需要进行建设。已经整理在 "),s("a",{attrs:{href:"https://gitee.com/zhijiantianya/ruoyi-vue-pro/issues/I4UPEU",target:"_blank",rel:"noopener noreferrer"}},[t._v("https://gitee.com/zhijiantianya/ruoyi-vue-pro/issues/I4UPEU "),s("OutboundLink")],1),t._v("链接中，你也可以提一些功能的想法。")]),t._v(" "),s("p",[t._v("如果您有参与工作流开发的想法，可以添加我的微信 "),s("strong",[t._v("wangwenbin10")]),t._v(" ！")]),t._v(" "),s("p",[t._v("艿艿会带着你做技术方案，Code Review 你的每一行代码的实现。相信在这个过程中，你会收获不错的技术成长！")])])}),[],!1,null,null,null);s.default=r.exports},688:function(t,s,a){t.exports=a.p+"assets/img/img.c9ba0180.png"},689:function(t,s,a){t.exports=a.p+"assets/img/img_1.d421a7d6.png"},690:function(t,s,a){t.exports=a.p+"assets/img/img_2.8f2713b2.png"},691:function(t,s,a){t.exports=a.p+"assets/img/img_3.56cc258f.png"},692:function(t,s,a){t.exports=a.p+"assets/img/img_4.70d6792a.png"},693:function(t,s,a){t.exports=a.p+"assets/img/img_5.54ff1109.png"},694:function(t,s,a){t.exports=a.p+"assets/img/img_6.cc1cad85.png"},695:function(t,s,a){t.exports=a.p+"assets/img/img_7.1fbd581e.png"},696:function(t,s,a){t.exports=a.p+"assets/img/img_8.0caf3d77.png"},697:function(t,s,a){t.exports=a.p+"assets/img/img_9.3a940ea6.png"},698:function(t,s,a){t.exports=a.p+"assets/img/img_10.c3025cbd.png"},699:function(t,s,a){t.exports=a.p+"assets/img/img_11.181d8da5.png"},700:function(t,s,a){t.exports=a.p+"assets/img/img_12.b1dc0431.png"},701:function(t,s,a){t.exports=a.p+"assets/img/img_13.ad7b3ef2.png"},702:function(t,s,a){t.exports=a.p+"assets/img/img_14.7fa1d7a4.png"},703:function(t,s,a){t.exports=a.p+"assets/img/img_15.07fe9a85.png"},704:function(t,s,a){t.exports=a.p+"assets/img/img_16.f6022e6c.png"},705:function(t,s,a){t.exports=a.p+"assets/img/img_17.ff7c0778.png"},706:function(t,s,a){t.exports=a.p+"assets/img/img_18.d6a5889d.png"},707:function(t,s,a){t.exports=a.p+"assets/img/img_19.a92a47d9.png"},708:function(t,s,a){t.exports=a.p+"assets/img/img_20.0504e8fb.png"},709:function(t,s,a){t.exports=a.p+"assets/img/img_21.9e2851c9.png"},710:function(t,s,a){t.exports=a.p+"assets/img/img_22.af30c5fa.png"},711:function(t,s,a){t.exports=a.p+"assets/img/img_23.40257fbc.png"},712:function(t,s,a){t.exports=a.p+"assets/img/img_24.577da6c5.png"},713:function(t,s,a){t.exports=a.p+"assets/img/img_25.b4cc862e.png"},714:function(t,s,a){t.exports=a.p+"assets/img/img_26.b8bcafa7.png"},715:function(t,s,a){t.exports=a.p+"assets/img/img_27.0caf3d77.png"},716:function(t,s,a){t.exports=a.p+"assets/img/img_28.3a940ea6.png"},717:function(t,s,a){t.exports=a.p+"assets/img/img_29.251c112c.png"},718:function(t,s,a){t.exports=a.p+"assets/img/img_30.3c9aeb76.png"},719:function(t,s,a){t.exports=a.p+"assets/img/img_31.04bc6172.png"},720:function(t,s,a){t.exports=a.p+"assets/img/img_32.32889c1d.png"},721:function(t,s,a){t.exports=a.p+"assets/img/img_33.f46a6ba4.png"},722:function(t,s,a){t.exports=a.p+"assets/img/img_34.cf0b4d5a.png"}}]);